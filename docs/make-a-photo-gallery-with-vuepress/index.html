<!doctype html><html lang=en><head><meta charset=utf-8><meta content=no-referrer name=referrer><meta content="width=device-width,initial-scale=1.0,maximum-scale=5" name=viewport><title>Make a Photo Gallery with Vuepress | Jiacheng's Mini Blog</title><meta content="Make a Photo Gallery with Vuepress | Jiacheng's Mini Blog" property=og:title><meta content="Make a Photo Gallery with Vuepress | Jiacheng's Mini Blog" name=twitter:title><meta content="Vuepress is a simple framework to generate static webpages. I had that idea to use vuepress to make a static photo gallery for my own website." name=description><meta content="Vuepress is a simple framework to generate static webpages. I had that idea to use vuepress to make a static photo gallery for my own website." property=og:description><meta content="Vuepress is a simple framework to generate static webpages. I had that idea to use vuepress to make a static photo gallery for my own website." name=twitter:description><meta content="Jiacheng's Mini Blog" property=og:site_name><meta content=https://jason0214.github.io property=og:url><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://jason0214.github.io/base.css rel=stylesheet><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet><link href=https://jason0214.github.io/fontawesome/fontawesome.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/brands.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/solid.css rel=stylesheet><link href=https://jason0214.github.io/favicon.ico rel=icon type=image/x-icon><body><a class="skip-link p-screen-reader-text" href=#main>Skip to content</a><header class=l-header><h1 class="c-title p-title"><a class=p-title__link href=https://jason0214.github.io>Jiacheng's Mini Blog</a></h1><p class=p-subtitle>Less tech, more life</header><main class=l-main id=main><article class=p-article><header><h1>Make a Photo Gallery with Vuepress</h1><div><div class=c-time><time datetime=" 2020-06-07"> 2020-06-07 </time> - (5 min read)</div></div></header><section class=p-article__body id=js-article><p><a href=https://github.com/vuejs/vuepress>Vuepress</a> is a simple framework to generate static webpages. I had that idea to use vuepress to make a static photo gallery for my own website.</p><span id=continue-reading></span><h2 id=give-image-path-in-markdown-and-no-more>Give image path in markdown and no more<a aria-label="Anchor link for: give-image-path-in-markdown-and-no-more" class=zola-anchor href=#give-image-path-in-markdown-and-no-more><i class="fas fa-link"></i></a></h2><p>The only design principle is to create a gallery page by providing only image paths.<pre class=language-md data-lang=md style=color:#c0c5ce;background-color:#2b303b><code class=language-md data-lang=md><span>...
</span><span style=color:#bf616a>- ![foo1](foo1.jpg)
</span><span style=color:#bf616a>- ![foo2](foo2.jpg)
</span><span style=color:#bf616a>- ![foo3](foo3.jpg)
</span><span style=color:#bf616a>....
</span></code></pre><p>You'll have to write a <a href=https://vuepress.vuejs.org/theme/default-theme-config.html#custom-layout-for-specific-pages>custom vue component</a> where you can put style sheet and scripts to handle layouts and other more functionalities.<p>Vuepress will parse the markdown and include it into your custom component to do a server side rendering, which outputs a static webpage.<h2 id=vary-width-grid-view-with-flexbox>Vary width grid view with flexbox<a aria-label="Anchor link for: vary-width-grid-view-with-flexbox" class=zola-anchor href=#vary-width-grid-view-with-flexbox><i class="fas fa-link"></i></a></h2><p>A vary-width grid view of elements can be made very easy with <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/flex-wrap>flex-wrap</a>.<p>Display size of the element along the <code>flex-direction</code> is calculated based on <code>flex-grow</code> and the actual size of the element (e.g. the image width if <code>flex-direction: row</code>).<p><img alt=flex-wrap-anim src=https://i0.wp.com/css-tricks.com/wp-content/uploads/2014/03/flexbox-space-filling.gif> If elements overflow a row flex container, those that can not fit into the first row will be wrapped to the second row, so on and so forth.<p>In the align direction, just hard code the height to be some value, 40vh (40% of the display height) looks good for photos according to some posts I read.<p>For the markdown example above, it renders<pre class=language-html data-lang=html style=color:#c0c5ce;background-color:#2b303b><code class=language-html data-lang=html><span>&lt;</span><span style=color:#bf616a>ul</span><span>>
</span><span>    ...
</span><span>    &lt;</span><span style=color:#bf616a>li</span><span>>&lt;</span><span style=color:#bf616a>img </span><span style=color:#d08770>src</span><span>="</span><span style=color:#a3be8c>foo1.jpg</span><span>"/>&lt;/</span><span style=color:#bf616a>li</span><span>>
</span><span>    &lt;</span><span style=color:#bf616a>li</span><span>>&lt;</span><span style=color:#bf616a>img </span><span style=color:#d08770>src</span><span>="</span><span style=color:#a3be8c>foo2.jpg</span><span>"/>&lt;/</span><span style=color:#bf616a>li</span><span>>
</span><span>    &lt;</span><span style=color:#bf616a>li</span><span>>&lt;</span><span style=color:#bf616a>img </span><span style=color:#d08770>src</span><span>="</span><span style=color:#a3be8c>foo3.jpg</span><span>"/>&lt;/</span><span style=color:#bf616a>li</span><span>>
</span><span>    ...
</span><span>&lt;/</span><span style=color:#bf616a>ul</span><span>>
</span></code></pre><p>So in the gallery component, style is set as:<pre class=language-stylus data-lang=stylus style=color:#c0c5ce;background-color:#2b303b><code class=language-stylus data-lang=stylus><span style=color:#bf616a>ul
</span><span>    display: </span><span style=color:#bf616a>flex</span><span>;
</span><span>    flex-wrap: </span><span style=color:#bf616a>wrap</span><span>;
</span><span>    list-style-type: </span><span style=color:#d08770>none</span><span>;
</span><span>    padding: </span><span style=color:#d08770>0</span><span>;
</span><span>
</span><span style=color:#bf616a>li
</span><span>    height: </span><span style=color:#d08770>40vh</span><span>;
</span><span>    flex-grow: </span><span style=color:#d08770>1</span><span>;
</span><span>    list-style-type: </span><span style=color:#d08770>none</span><span>;
</span><span>
</span><span style=color:#bf616a>img
</span><span>    max-height: </span><span style=color:#d08770>100%</span><span>;
</span><span>    min-width: </span><span style=color:#d08770>100%</span><span>;
</span></code></pre><p>Note that the image is resized in this setup, check out <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit>object-fit</a> if you want to keep its aspect ratio.<pre class=language-stylus data-lang=stylus style=color:#c0c5ce;background-color:#2b303b><code class=language-stylus data-lang=stylus><span style=color:#bf616a>img
</span><span>    object-fit: </span><span style=color:#bf616a>cover</span><span>;
</span><span>    max-height: </span><span style=color:#d08770>100%</span><span>;
</span><span>    min-width: </span><span style=color:#d08770>100%</span><span>;
</span></code></pre><p>For responsive on phone, have the <code>&lt;li></code> to be <code>width: 100%</code> which forces one image each row.<pre class=language-stylus data-lang=stylus style=color:#c0c5ce;background-color:#2b303b><code class=language-stylus data-lang=stylus><span style=color:#b48ead>@media </span><span>(max-width: $MQMobile)
</span><span style=color:#b48ead>    </span><span style=color:#bf616a>li
</span><span>      max-height: </span><span style=color:#d08770>55vh</span><span>;
</span><span>      width: </span><span style=color:#d08770>100%</span><span>;
</span><span>
</span><span style=color:#b48ead>@media </span><span>(max-width: $MQMobileNarrow)
</span><span style=color:#b48ead>    </span><span style=color:#bf616a>li
</span><span>      max-height: </span><span style=color:#d08770>75vh</span><span>;
</span><span>      width: </span><span style=color:#d08770>100%</span><span>;
</span></code></pre><h2 id=nasty-last-row>Nasty last row<a aria-label="Anchor link for: nasty-last-row" class=zola-anchor href=#nasty-last-row><i class="fas fa-link"></i></a></h2><p>Flexbox has the drawback that it can not perfectly handle <code>flex-grow</code> together with responsiveness, at least as far as I know.<p>For an extreme example, if only one photo is left to the last row, it would be stretched to the row width (default <code>flex-grow: 1</code>).<p><img alt=make-a-photo-gallery-with-vuepress_last-row-stretch src=https://jason0214.github.io/make-a-photo-gallery-with-vuepress/./static/make-a-photo-gallery-with-vuepress_last-row-stretch.jpg> The <a href=http://localhost:8080/posts/make-a-photo-gallery-with-vuepress.html>last-child selector</a> can be used to change the last photo's <code>flex-grow</code> to <code>0</code>, so that it does not stretch.<p>In my opinion, it does not entirely solve the issue. When resolution changes on other devices, this last photo could be in a row together with other photos. In the example below, there are two photos in the last row, the <code>flex-grow</code> difference still causes one photo to stretch.<p><img alt=make-a-photo-gallery-with-vuepress_last-child-selector.jpg src=https://jason0214.github.io/make-a-photo-gallery-with-vuepress/./static/make-a-photo-gallery-with-vuepress_last-child-selector.jpg> The takeaway is that it is hard to make it perfect on every device. Tune the order of the photos to till it looks good on one device and forget about others. Not such a big deal, as it is not an issue on very narrow screens (phones) where every row has only one photo.<h2 id=lazy-loading>Lazy loading<a aria-label="Anchor link for: lazy-loading" class=zola-anchor href=#lazy-loading><i class="fas fa-link"></i></a></h2><p>A thumbnail auto generation is hard to fit into the vuepress infrastructure. Using original photos in the gallery preview definitely burdens networking and rendering. (Browsers usually re-render when a new image is loaded.)<p>Lazy loading, which loads images only when they are visible, is natively supported in most browsers. An <code>&lt;img/></code> with attribute <code>loading="lazy"</code> should be lazy loaded. Using markdown plugin such as <a href=https://github.com/ruanyf/markdown-it-image-lazy-loading>[1]</a> easily converts your markdown images to lazy loaded.<p>However, there is something about lazy loading with Chrome according to <a href=https://stackoverflow.com/questions/57753240/native-lazy-loading-loading-lazy-not-working-even-with-flags-enabled>[2]</a>, which I also reproduced and verified. Chrome (version 83.0.4103.97) is kinda aggressive about loading. It loads image far ahead of your visible window, which is a bad thing for webpage with all photos. Firefox does not have this issue (or feature).<p>Note that images initially have no width. Therefore, images are in the same flex row before they get loaded.<p><img alt=make-a-photo-gallery-with-vuepress_initial-one-row.jpg src=https://jason0214.github.io/make-a-photo-gallery-with-vuepress/./static/make-a-photo-gallery-with-vuepress_initial-one-row.jpg> So even with lazy loading, more than necessary images are loaded in the first place (Think about when images are loaded, they wrap around and push the content below into invisible regions).<p>To make it better, one possible approach is to make the image container (<code>&lt;li></code> in the context) reactive. Provides it with a hard coded <code>width</code> in server side rendering, then use a js based lazy loading and set a callback to flip the <code>width</code> to <code>auto</code> after the image is loaded.<p>TODO: Alter <code>src</code> to <code>data-src</code> and do lazy loading manually with <a href=https://github.com/ApoorvSaxena/lozad.js/>lozad</a>.<h2 id=photo-viewer>Photo viewer<a aria-label="Anchor link for: photo-viewer" class=zola-anchor href=#photo-viewer><i class="fas fa-link"></i></a></h2><p>TODO: Add a photo viewer with <a href=https://github.com/mirari/v-viewer>v-viewer</a>. Should be straightforward, just inject a click event for each <code>&lt;img></code> in <code>mounted()</code>.<h2 id=reference>Reference<a aria-label="Anchor link for: reference" class=zola-anchor href=#reference><i class="fas fa-link"></i></a></h2><ul><li><a href=https://css-tricks.com/filling-space-last-row-flexbox/>https://css-tricks.com/filling-space-last-row-flexbox/</a><li><a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Mastering_Wrapping_of_Flex_Items>https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Mastering_Wrapping_of_Flex_Items</a><li><a href=https://css-tricks.com/adaptive-photo-layout-with-flexbox/>https://css-tricks.com/adaptive-photo-layout-with-flexbox/</a></ul></section><footer><nav class="c-pagination p-pagination"><div class=c-pagination__ctrl><div class=c-pagination__newer></div><div class=c-pagination__older></div></div></nav></footer></article></main><footer class=l-footer><p class=p-copyright></footer>