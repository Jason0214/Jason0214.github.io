<!doctype html><html lang=en><head><meta charset=utf-8><meta content=no-referrer name=referrer><meta content="width=device-width,initial-scale=1.0,maximum-scale=5" name=viewport><title>Shallow Dive on Microfacet | Jiacheng's Mini Blog</title><meta content="Shallow Dive on Microfacet | Jiacheng's Mini Blog" property=og:title><meta content="Shallow Dive on Microfacet | Jiacheng's Mini Blog" name=twitter:title><meta content="Physically based rendering is a recent hot area in game theindustry. Most PBR implementation employs a microfacet model to parameterize the features of the material surface. Here is a very shallow dive on microfacet." name=description><meta content="Physically based rendering is a recent hot area in game theindustry. Most PBR implementation employs a microfacet model to parameterize the features of the material surface. Here is a very shallow dive on microfacet." property=og:description><meta content="Physically based rendering is a recent hot area in game theindustry. Most PBR implementation employs a microfacet model to parameterize the features of the material surface. Here is a very shallow divâ€¦" name=twitter:description><meta content="Jiacheng's Mini Blog" property=og:site_name><meta content=https://jason0214.github.io property=og:url><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://jason0214.github.io/base.css rel=stylesheet><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet><link href=https://jason0214.github.io/fontawesome/fontawesome.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/brands.css rel=stylesheet><link href=https://jason0214.github.io/fontawesome/solid.css rel=stylesheet><link href=https://jason0214.github.io/favicon.ico rel=icon type=image/x-icon><body><a class="skip-link p-screen-reader-text" href=#main>Skip to content</a><header class=l-header><h1 class="c-title p-title"><a class=p-title__link href=https://jason0214.github.io>Jiacheng's Mini Blog</a></h1><p class=p-subtitle>Less tech, more life</header><main class=l-main id=main><article class=p-article><header><h1>Shallow Dive on Microfacet</h1><div><div class=c-time><time datetime=" 2018-08-27"> 2018-08-27 </time> - (3 min read)</div></div></header><section class=p-article__body id=js-article><p>Physically based rendering is a recent hot area in game theindustry. Most PBR implementation employs a <em><strong>microfacet model</strong></em> to parameterize the features of the material surface. Here is a very shallow dive on microfacet.</p><span id=continue-reading></span><h2 id=microfacet-model>Microfacet model<a aria-label="Anchor link for: microfacet-model" class=zola-anchor href=#microfacet-model><i class="fas fa-link"></i></a></h2><p>In the microfacet model, a surface consists of millions of micro surfaces, with each micro surface being perfectly smooth. Each micro surface has a normal where only perfect reflection happens.<p><img alt=microfacet_visual src=https://jason0214.github.io/shallow-dive-microfacet/./static/shallow-dive-on-microfacet_half-vector.png><p>Note that micro surface normals are somewhat related to the "macro" surface normal, but it's not the same. An incident light to a rough surface will be scattered into different directions by every micro surface it can hit.<p>Normal of the micro surface is called <code>half-vector</code> and denoted by <code>h</code>. Obviously, <code>h = normalize(l + v)</code> where <code>l</code> is the light direction and <code>v</code> is the view direction.<h2 id=microfacet-formula>Microfacet formula<a aria-label="Anchor link for: microfacet-formula" class=zola-anchor href=#microfacet-formula><i class="fas fa-link"></i></a></h2><p>A general form of microfacet model<p><img alt=microfacet_model src=https://jason0214.github.io/shallow-dive-microfacet/./static/shallow-dive-on-microfacet_formula.png><p>has four terms <strong>diffuse</strong>, <strong>distribution term (D)</strong>, <strong>fresnel term (F)</strong> and <strong>geometry term(G)</strong>. These four terms are always present for all the microfacet models, while the actual implementation of each term may differ by models.<h2 id=distribution-term>Distribution term<a aria-label="Anchor link for: distribution-term" class=zola-anchor href=#distribution-term><i class="fas fa-link"></i></a></h2><p>Distribution describes how many micro surfaces are hit in the light direction.<h2 id=fresnel-term>Fresnel term<a aria-label="Anchor link for: fresnel-term" class=zola-anchor href=#fresnel-term><i class="fas fa-link"></i></a></h2><p>Fresnel term describes the physical phenomenon that for any lit surfaces, the amount of light reflected is related to the incident light angle.<p><img alt=fresnel src=https://jason0214.github.io/shallow-dive-microfacet/./static/shallow-dive-on-microfacet_natural-fresnel.png><p>In the above real world example, in the nearby area where the angle between view(light) direction and water surface normal is small, transmission (refraction) dominates. However in the far area where the angle difference is larger, most of the light is reflected.<h2 id=geometry-term>Geometry term<a aria-label="Anchor link for: geometry-term" class=zola-anchor href=#geometry-term><i class="fas fa-link"></i></a></h2><p>Geometry term measures the amount of incident light and light reflected from micro surfaces that in the end is blocked by other micro surfaces.<p><img alt=shadow_mask src=https://jason0214.github.io/shallow-dive-microfacet/./static/shallow-dive-on-microfacet_v-shape.png><p>See the above deep v-shaped micro surfaces, some incident light is blocked which causes part of the surface in shadow, and some reflected light is masked by the surface itself as well.<h2 id=well-known-microfacet-models>Well-known microfacet models<a aria-label="Anchor link for: well-known-microfacet-models" class=zola-anchor href=#well-known-microfacet-models><i class="fas fa-link"></i></a></h2><ul><li><a href=https://ieeexplore.ieee.org/document/1138991/>Smith Geometrical shadow</a> an old and successful geometry shadow-mask model, adopted by a lot of recent PBR models.<li><a href=http://www1.cs.columbia.edu/CAVE/publications/pdfs/Oren_SIGGRAPH94.pdf>Oren Nayar Diffuse</a> an improvement over the traditional Lambert diffuse model.<li><a href=https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-8659.1330233>Schlick</a> famous for its approximation on fresnel and geometry terms, well adopted model.<li><a href=https://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.html>GGX</a> extends microfacet BRDF to refraction and transmission. It introduces a new GGX distribution term together with a geometry term which is based on the Smith's model mentioned above. (Note a very good, self-contained paper)<li><a href=https://disney-animation.s3.amazonaws.com/library/s2012_pbs_disney_brdf_notes_v2.pdf>Disney Principle</a> is a mix of GGX model and Schlick mode with its new diffuse term. It is adopted by Blender and seems to be the industrial standard.</ul><h2 id=reference>Reference<a aria-label="Anchor link for: reference" class=zola-anchor href=#reference><i class="fas fa-link"></i></a></h2><ul><li><a href=http://simonstechblog.blogspot.com/2011/12/microfacet-brdf.html>http://simonstechblog.blogspot.com/2011/12/microfacet-brdf.html</a><li><a href=https://disney-animation.s3.amazonaws.com/library/s2012_pbs_disney_brdf_notes_v2.pdf>https://disney-animation.s3.amazonaws.com/library/s2012_pbs_disney_brdf_notes_v2.pdf</a><li><a href=https://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.html>https://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.html</a><li><a href=http://www1.cs.columbia.edu/CAVE/publications/pdfs/Oren_SIGGRAPH94.pdf>http://www1.cs.columbia.edu/CAVE/publications/pdfs/Oren_SIGGRAPH94.pdf</a><li><a href=https://ieeexplore.ieee.org/document/1138991/>https://ieeexplore.ieee.org/document/1138991/</a><li><a href=https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-8659.1330233>https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-8659.1330233</a></ul></section><footer><nav class="c-pagination p-pagination"><div class=c-pagination__ctrl><div class=c-pagination__newer></div><div class=c-pagination__older></div></div></nav></footer></article></main><footer class=l-footer><p class=p-copyright></footer>